import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression

# ğŸ ì˜ˆì œ ë°ì´í„°: í‚¤(cm)ì™€ ì‹ ë°œ ì‚¬ì´ì¦ˆ(mm)
data_list = [
    [160, 235],
    [165, 240],
    [170, 250],
    [175, 255],
    [180, 260],
    [185, 270],
    [190, 280]
]

# 1. ğŸ¼ ë°ì´í„° ì¤€ë¹„: Pandas DataFrame ìƒì„±
df = pd.DataFrame(data_list, columns=['í‚¤(cm)', 'ì‹ ë°œ ì‚¬ì´ì¦ˆ(mm)'])

# í‚¤(ë…ë¦½ ë³€ìˆ˜, X)ì™€ ì‹ ë°œ ì‚¬ì´ì¦ˆ(ì¢…ì† ë³€ìˆ˜, Y) ë¶„ë¦¬
# Scikit-learn ì…ë ¥ì— ë§ê²Œ XëŠ” DataFrame, YëŠ” Series í˜•íƒœë¡œ ì¶”ì¶œ
# ğŸ”‘ í•µì‹¬: XëŠ” DataFrame. YëŠ” Series(1ì°¨ì›) í˜•íƒœë¡œ ìœ ì§€
X_df = df[['í‚¤(cm)']]       # 2ì°¨ì› DataFrame (í‚¤)
Y_series = df['ì‹ ë°œ ì‚¬ì´ì¦ˆ(mm)'] # 1ì°¨ì› Series (ì‹ ë°œ ì‚¬ì´ì¦ˆ)

# 2. ğŸ§  ëª¨ë¸ í•™ìŠµ: LinearRegression ëª¨ë¸ ìƒì„± ë° í•™ìŠµ
model = LinearRegression()
# X_df (DataFrame)ì™€ Y_series (Series)ë¥¼ ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ì—¬ í•™ìŠµ
model.fit(X_df, Y_series)

# 3. ğŸ“‰ ì˜ˆì¸¡: í•™ìŠµëœ ëª¨ë¸ì„ ì´ìš©í•´ X ê°’ì— ëŒ€í•œ ì˜ˆì¸¡ Y ê°’ ìƒì„±
Y_pred = model.predict(X_df)

# 4. ğŸ“Š ê²°ê³¼ ì‹œê°í™”
plt.figure(figsize=(8, 6))

# ì‹¤ì œ ë°ì´í„° (ì‚°ì ë„) - Xì¶•ì— df['í‚¤(cm)'], Yì¶•ì— Y_series ì‚¬ìš©
# 4. ğŸ“Š Visualization of Results
plt.figure(figsize=(8, 6))

# Actual Data (Scatter Plot)
plt.scatter(df['í‚¤(cm)'], Y_series, color='blue', label='Actual Data (Height vs. Shoe Size)', marker='o')

# Linear Regression Line generated by the model - using df['í‚¤(cm)'] for X-axis and predicted values Y_pred for Y-axis
plt.plot(df['í‚¤(cm)'], Y_pred, color='red', label='Linear Regression Line', linewidth=2)

# Set graph title and axis labels
plt.title('Linear Regression Analysis of Shoe Size by Height (Pandas)')
plt.xlabel('Height (cm)')
plt.ylabel('Shoe Size (mm)')
plt.legend()
plt.grid(True, linestyle='--', alpha=0.6)
plt.show()

# ğŸ” Model Results Check
print(f"\nSlope (Coefficient): {model.coef_[0]:.4f}")
print(f"Intercept: {model.intercept_:.4f}")
print(f"Regression Equation: Shoe Size (Y) = {model.coef_[0]:.4f} * Height (X) + {model.intercept_:.4f}")